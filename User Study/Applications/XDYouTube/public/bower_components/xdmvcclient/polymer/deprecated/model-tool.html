<link rel="import" href="../../polymer/polymer.html">
<polymer-element name="model-tool" attributes="persistent transient url" >
    <template >
        <h2>Transient data</h2>
        <pre>{{prettyTransient}}</pre>
        <h2>Persistent data</h2>
        <pre>{{prettyPersistent}}</pre>
    
    </template>
	<script>
		Polymer('model-tool', {
            created: function() {
                this.persistent = {};
                this.transient = {};
                this.prettyTransient = "";
                this.prettyPersistent = "";
            },
            
            observe: {
                
                persistent: 'persistentChanged',   
                transient: 'transientChanged'   
            },
            
            prettyPrint: function(value){
                return JSON.stringify(value, null, 4);   
            },
            
            transientChanged: function(old, newVal){
                console.log("transient Changed"); 
                console.log(newVal); 
                var thisTransient = this.transient;
                var that = this;
                // To catch the first change
                this.prettyTransient = JSON.stringify(thisTransient, null, 4);
                
                // For future changes
                Object.observe(thisTransient, function() {
                    console.log(thisTransient);
                    that.prettyTransient = JSON.stringify(thisTransient, null, 4);
         //           console.log(pt);
                });
                

           },
            
            persistentChanged: function(old, newVal){
                console.log("persistent Changed");   
                console.log(newVal);
                var thisPersistent = this.persistent;
                var that = this;
                // To catch the first change
                that.prettyPersistent = JSON.stringify(thisPersistent, null, 4);
                
                // For future changes
                Object.observe(thisPersistent, function() {
                    console.log("test");
                    console.log(thisPersistent);
                    that.prettyPersistent = JSON.stringify(thisPersistent, null, 4);
        //            console.log(pp);
                });

        }
            
 	  
		});
	</script>
</polymer-element>