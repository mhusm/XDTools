<link rel="import" href="../../polymer/polymer.html">
<script src="../../js/xdmvc.js"></script>
<polymer-element name="xdmvc-others-roles">
	<template>
        <h2>Roles of connected devices</h2>
		<template repeat="{{o in othersRolesArray}}">
            <div >{{o.key }} {{o.value }}</div>
        </template>
	</template>
	<script>
		Polymer({
			created: function() {
                this.othersRoles = XDmvc.othersRoles;
                /* Polymer can not repeat over object properties yet, 
                  that is why it needs to be transformed into an object.
                  This may change in the future and then this piece of code could be refactored */
                this.othersRolesArray = [];
                var obs = new ObjectObserver(this.othersRoles);
                var updateArray = this.updateArray.bind(this);
                obs.open(function(added, removed, changed, getOldValueFn) {
                  updateArray();
                });
                updateArray();

			},
            
            
            updateArray: function(){
                this.othersRolesArray.length = 0;
                for (role in this.othersRoles) {
                    this.othersRolesArray.push({key: role, value: this.othersRoles[role]});   
                }
          }
		});
	</script>
</polymer-element>
